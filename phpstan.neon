includes:
    - vendor/larastan/larastan/extension.neon

parameters:
    paths:
        - src

    level: 5

    treatPhpDocTypesAsCertain: false
    reportUnmatchedIgnoredErrors: false

    ignoreErrors:
        # Eloquent Builder magic methods
        - '#Call to an undefined method Illuminate\\Database\\Eloquent\\Builder::#'
        - '#Call to an undefined method Illuminate\\Database\\Query\\Builder::#'

        # Chat facade alias (defined in composer.json)
        - '#on an unknown class Chat#'

        # Eloquent model dynamic properties (from database columns)
        - '#Access to an undefined property Musonza\\Chat\\Models\\[a-zA-Z]+::\$[a-zA-Z_]+#'

        # Eloquent model dynamic properties on base Model
        - '#Access to an undefined property Illuminate\\Database\\Eloquent\\Model::\$#'

        # Eloquent relation methods on Model
        - '#Call to an undefined method Illuminate\\Database\\Eloquent\\Model::#'

        # PHPDoc return type issues with Response
        - '#PHPDoc tag @return with type .* is not subtype of native type#'

        # PHPDoc type covariance issues
        - '#PHPDoc type .* of property .* is not covariant with#'

        # Larastan relation existence (false positives)
        - '#Relation .* is not found in#'

        # is_null checks that PHPStan thinks are always false
        - '#Call to function is_null\(\) .* will always evaluate to false#'

        # Collection|Model union type property access
        - '#Access to an undefined property Illuminate\\Database\\Eloquent\\Collection.*::\$#'

        # Model::make() suggestion (acceptable pattern)
        - '#performs unnecessary work, use#'

        # Notification $data property
        - '#Access to an undefined property Musonza\\Chat\\Notifications\\MessageSent::\$data#'

        # Unused trait (it's used by consumer applications)
        - '#Trait Musonza\\Chat\\Traits\\Messageable is used zero times#'

        # Type coercion for Model subclasses
        - '#expects Musonza\\Chat\\Models\\Message, Illuminate\\Database\\Eloquent\\Model given#'

        # Offset access on model
        - '#Offset 0 does not exist on#'

        # Return type mismatches in services
        - '#should return Musonza\\Chat\\Models\\Conversation but returns#'

    excludePaths:
        - vendor
